## 操作系统概述

### 一、计算机系统前置知识
+ 一般来说，计算机硬件的组织结构采用冯诺依曼基本原理。即“存储程序控制”原理，它一般归纳为控制器、运算器、存储器、输入设备和输出设备五类部件。
+ 典型的冯诺依曼计算机是以运算器为中心的逻辑组织结构，而现代计算机采用的是以存储器为中心的逻辑结构。
+ 中央处理器(CPU)是计算机的大脑，其工作流程为：取指、解码、执行指令；如此往复。
+ 高速缓存是CPU与内存之间的临时存储，用于提高CPU访存速度，现代CPU中主要设计了两级缓存，L1-Cache为CPU第一层缓存，分为数据缓存和指令缓存，第二级缓存为L2-Cache，因为只存储数据，没有指令缓存和数据缓存之分。如果有L3，L3如是。
+ CPU执行的程序是由一组保存在存储器中的指令组成的。
+ 中断机制可使CPU打断当前执行序列，转而处理中断处理程序程序，待中断处理程序完成之后再恢复原来的执行序列。
+ 处理中断的大致流程如下
  + 设备给处理器发出一个中断信号
  + 处理器执行完当前指令后检查中断信号
  + 有中断信号发送，处理器发送中断应答信号
  + 处理器将当前任务的现场信息保存下来，包括CS/IP，状态寄存器等
  + 根据中断号，找到中断向量表(中断描述符表)中的中断处理程序
  + 处理完中断处理程序之后返回。
  + 恢复之前保存的任务现场信息，包括CS/IP，状态寄存器等，继续任务的执行序列
+ 并发：指两个或两个以上的事物在同一时间间隔发送。
+ 并行：指两个或两个以上的事物在同一时刻发生。比如不同程序同时在多个硬件部件上执行。

### 二、操作系统是什么？
操作系统是计算机系统中的一个系统软件，是一些程序模块的集合。它要完成如下目标：
+ 能以尽量有效、合理的方式组织和管理计算机的软硬件资源。（资源利用率）
+ 合理地组织计算机的工作流程，控制程序的执行并向用户提供各种服务功能。（响应时间）
+ 使得用户能够灵活、方便地使用计算机，使整个计算机系统高效率运行。（方便使用）

#### 资源管理的观点
操作系统的任务就是跟踪程序的运行情况，了解程序需要什么资源，并满足他们的资源请求，记录它们对资源的使用情况，以及协调各个程序和用户对资源使用请求的冲突，并在此基础上最大可能地提高各种资源的利用率。从这一角度上考虑，操作系统就是系统资源的管理者，它必须完成以下工作：
+ 跟踪和监控程序的运行情况，记录程序的运行状态
+ 进行计算机各种资源（如处理机、内存、输入输出设备）的分配
+ 回收资源，以便再分配。
  
##### 那么，怎样管理资源？
+ 跟踪记录资源的使用状况。如哪些资源空闲，分配给谁使用，允许多长时间等
+ 确定资源分配策略--算法。是采用静态分配策略还是动态分配策略。
+ 实施资源的分配和回收
+ 提高资源利用率
+ 保护资源的使用
+ 协调多个进程对资源请求的冲突

从资源管理这一角度出发，操作系统被划分成处理机管理、存储管理、文件管理、设备管理及用户接口。

#### 用户的观点
操作系统对于用户来说就是一台虚拟机，是帮助用户解决问题的设备，用户要求它性能稳定、可靠，使用起来简单，灵活。除此之外，用户还要求操作系统提供如下功能：
+ 为用户创造适宜的工作环境，便于用户控制自己的程序运行。
+ 应配置各种子系统（编辑程序、编译程序、装配程序和调试程序等）以及程序库（如服务程序库和应用程序库），便于用户编写、调试、修改和运行自己的程序，增强用户的解题能力。
+ 为了简化输入输出操作，统一资源的分配管理，系统应提供方便的数据操作接口。
+ 为用户使用计算机提供灵活、方便、友好的用户界面。



### 三、为什么需要操作系统（操作系统做了什么）

#### 操作系统的功能

##### 进程管理
进程管理也称处理机管理，其目标是提高CPU的利用率。大致可分为如下几个方面
1. 进程控制：指创建进程、撤销进程以及控制进程在运行过程中的状态转换。
2. 进程同步：进程在执行过程中是以不可预知的方式向前推进的，进程之间有时需要进行协调，协调方式有互斥和同步两种方式。
   1. 互斥：系统中某些资源要求只能有一个进程对它们进行访问。
   2. 同步：进程在执行时，有时需要协作，一个进程运行时需要另一个进程的运行结果，此时就要求进程的执行必须按照指定规定的次序进行。
3. 进程通信：其任务是实现相互合作进程之间的信息传递。
4. 进程调度：多个准备好运行的进程按照一定的算法选择其中一个，并让其占用处理机执行。

##### 存储管理
存储管理的要管理的资源是内存。其目标是提高内存的利用率以及从逻辑上使用内存。主要包括：
1. 内存分配：操作系统为要运行的程序分配内存空间，使其能装入内存运行。当程序需要增加内存空间时，操作系统能为其分配，并在不用的时候能够回收内存。
2. 地址映射：帮助程序的汇编地址在运行过程中能找到真正的物理地址。
3. 内存保护：在多道程序环境中，存储管理需要保证用户程序之间彼此隔离，只能访问自己的存储空间，不能访问其他范围内的信息。
4. 内存扩充：其任务是在逻辑上扩充内存。程序运行时，仅将用户程序的一部分装入内存使之与行，当程序需要的运行不在内存中的那部分程序时，再将需要的那部分程序装入内存，此时若内粗没有空闲空间，就将目前暂时不运行的程序先置换出去。
   
##### 设备管理
设备管理的主要任务如下。
1. 完成用户提出的输入输出请求，为用户分配外部设备。
2. 提高外部设备的利用率
3. 尽可能提高输入输出的速度。
4. 方便用户使用外部设备。
要完成以上任务，设备管理需要提供如下所述的功能。
1. 设备分配：设备分配的任务就是根据用户的输入输出请求为之分配所需的设备，如果输入输出设备和CPU之间还存在设备控制器和通道，设备分配时还要分配控制器和通道。
2. 设备控制：通常指CPU和设备之间的通信
3. 设备的无关性：指应用程序独立于具体的物理设备，用户的程序与实际使用的物理设备无关。
   
##### 文件管理
程序和数据等信息是以文件的形式存储在计算机中的，所以信息资源管理也称文件管理。一般文件管理具备如下功能：
1. 文件存储空间的管理：其主要任务是为每个文件分配必要的存储空间，提高存储空间的利用率，并提高文件系统的工作速度。
2. 目录管理：为了使用户更方便的找到其所需要的文件，通常由系统为每个文件建立一个目录项。目录管理的任务如下。
   1. 为每个文件建立其目录项，对众多目录项加以有效的管理，实现按名存取。即用户只需提供文件名就可以对文件进行存取。
3. 文件的读写管理：文件的读写是对文件的最基本操作，即根据用户的请求，从磁盘上读入数据或将数据写到磁盘上去。
4. 文件的存取控制：为防止系统中的文件被非法窃取和破坏，在文件系统中必须提供有效的存取控制功能，以实现以下目标：
   1. 防止未经核准的用户存取文件
   2. 防止冒名顶替存取文件。
   3. 防止以不正确的方式使用文件。
   在文件系统中可以采取多级保护措施来达到上述目标，具体如下。
   1. 系统级存取控制。用口令或对口令加密的方法进行。
   2. 用户级存取控制。对用户进行分类和对用户分配适当的文件存取权限。
   3. 文件级存取控制。通过对文件设置文件属性（只读、只可执行、可读写）来控制对文件的存取。

##### 操作系统接口
为了方便用户使用操作系统，操作系统向用户提供了用户与操作系统的接口，该接口分为命令接口和程序接口。
1. 命令接口：为方便用户控制自己的作业，操作系统向用户提供了命令接口。命令接口又可分为联机命令接口、脱机命令接口、图形用户界面接口。
2. 程序接口：程序接口又称为系统调用，是用户程序取得操作系统服务的唯一途径。使CPU状态从用户态陷入内核态。

### 四、操作系统的其他介绍

#### 操作系统的特征
1. 并发性：并发指处理多个同时活动的能力；宏观上，这些程序同时在执行。微观上，任何时刻只有一个程序真正在执行，即这些程序在CPU上是轮流执行的。
2. 共享性：操作系统与多个用户的程序共同使用计算机系统中的资源（共享有限的系统资源）。操作系统要对系统资源进行合理分配和使用。
3. 虚拟性：指通过某种技术手段把一个物理实体映射为若干个对应的逻辑实体（分时或分空间）。虚拟是操作系统管理系统资源的重要手段，可提高资源利用率。
4. 不确定性：操作系统的运行在一个不确定的环境中运行。因为在多道程序环境下，进程的执行是“走走停停”的。操作系统必须随时对不可预测的次序发生的事件进行响应并处理。

#### 典型操作系统的类型
##### 批处理操作系统
1. 单道批处理操作系统
2. 多道批处理操作系统
##### 分时操作系统
1. 单道分时操作系统
2. 具有“前台”和“后台的分时操作系统
3. 多道分时操作系统
##### 实时操作系统
1. 实时控制系统
2. 实时信息处理系统
##### 微机操作系统
##### 网络操作系统
##### 分布式操作系统
##### 嵌入式操作系统

