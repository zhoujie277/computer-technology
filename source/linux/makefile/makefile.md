# Makefile 工作原理
1. 基本原则：若想生成目标，检查规则中的依赖条件是否存在，如不存在，则寻找是否有规则用来生成该依赖文件。
2. 检查规则中的目标是否需要更新，必须先检查它的所有依赖，依赖中有任一个被更新，则目标必须更新。
   1. 分析各个目标和依赖之间的关系
   2. 根据依赖关系自底向上执行命令
   3. 根据修改时间比目标新，确定更新
   4. 如果目标不依赖任何条件，则执行对应命令，以示更新。

```
// hello：生成的目标名
// hello.c 生成目标依赖的文件
// 紧接着一个tab，生成目标的方法（命令）
hello:hello.c           
	gcc hello.c -o hello
```

### Makefile 变量
在 Makefile 中使用变量类似于 C 语言的宏定义，使用该变量相当于内容替换，使用变量可以使 Makefile 易于维护，修改内容变得简单。
+ 变量定义使用‘=’
+ '+=' 可追加变量
+ ’:=' 恒等于，可定义常量
+ 使用变量值用$(变量名)
```
# 变量定义及使用
foo = abc
bar = $(foo)
# 以上定义了两个变量：foo、bar，其中 bar 的值是 foo 变量值的引用。
```

#### 自动变量
```
$@  #表示规则中的目标
$<  #表示规则中的第一个条件。如果将该变量应用在模式规则中，它可将依赖条件列表中的依赖依次取出，套用模式规则。
$^  #表示规则中的所有条件，组成一个列表，以空格隔开，如果这个列表中有重复的项则消除重复项。
```

##### 模式规则
至少在规则的目标定义中要包含 ‘%’，‘%’ 表示一个或多个，在依赖条件中同样可以使用 ‘%’, 依赖条件中的 '%' 的取值，取决于其目标

##### 静态模式规则

##### 伪目标
.PHONY clean ALL


### Makefile 函数
```
// 匹配当前工作目录下的所有.c文件，将文件名组成列表，赋值给变量 src
    src = $(wildcard ./*.c) 

// 将参数 3 中，包含参数 1 的部分，替换为参数 2
    obj = $(patsubst %.c, %.o, $(src))
```


命名：makefile or Makefile
1个规则：
    目标：依赖条件
            （一个tab缩进）命令